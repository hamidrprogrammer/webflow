<!DOCTYPE html>
<html>
<head>
  <base href="/">
  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="description" content="A new Flutter project.">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="sharepoint_auth_app">
  <link rel="apple-touch-icon" href="icons/onenote.jpg">
  <link rel="icon" type="image/png" href="onenote.jpg"/>
  <title>solutionsapps onenote</title>
  <link rel="manifest" href="manifest.json">

  <!-- MSAL JS SDK -->
  <script type="text/javascript" src="https://alcdn.msauth.net/browser/2.35.0/js/msal-browser.min.js"></script>

  <script>
    const msalConfig = {
      auth: {
        clientId: '356fe2ef-4e6c-4719-bfa5-1b2996c41fcd',
        authority: 'https://login.microsoftonline.com/common',
        redirectUri: window.location.origin
      }
    };

    const msalInstance = new msal.PublicClientApplication(msalConfig);

    function microsoftSignIn() {
      return msalInstance.loginPopup({
        scopes: ["User.Read"]
      }).then(loginResponse => {
        console.log("Login response:", loginResponse);
        return loginResponse;
      }).catch(error => {
        console.error("Error during Microsoft Sign-In:", error);
        return null;
      });
    }

    // âœ… Attach correctly without causing recursion
    window.microsoftSignIn = microsoftSignIn;
  </script>
</head>
<body>
  <script src="flutter_bootstrap.js" defer></script>
</body>
</html>
